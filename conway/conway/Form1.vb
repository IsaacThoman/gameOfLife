Public Class Form1

    Dim cells(36, 36) As Boolean
    Dim iterationCount As Integer
    Dim timerOn As Boolean
    Dim superSpeedy As Integer = 1

    Dim underpopulation As Boolean = True
    Dim overpopulation As Boolean = True
    Dim birth As Boolean = True


    Function saveboard() As String
        Dim savedString As String = ""

        For saverx As Integer = 1 To 35
            For savery As Integer = 1 To 35

                If cells(saverx, savery) = True Then
                    savedString = savedString & "1"
                Else
                    savedString = savedString & "0"
                End If
            Next
            ' savedString = savedString & vbNewLine
        Next
        saveboard = savedString
    End Function

    Function clearboard()
        iterationCount = 0
        iterationLabel.Text = "Iterations: 0"
        For clearX = 1 To 35
            For clearY = 1 To 35
                cells(clearX, clearY) = False




            Next
        Next
    End Function


    Function loadBoard(input As String)
        Dim counter As Integer = 0

        For loaderX As Integer = 1 To 35
            For loaderY As Integer = 1 To 35
                counter += 1
                If GetChar(input, counter) = "1" Then
                    cells(loaderX, loaderY) = True
                Else
                    cells(loaderX, loaderY) = False
                End If
            Next
        Next


    End Function


    Function doIteration()
        Dim neighbors(35, 35) As Integer
        For fillerx As Integer = 1 To 35
            For fillery As Integer = 1 To 35

                Dim myX As Integer = fillerx
                Dim myY As Integer = fillery


                If cells(myX + 1, myY + 1) = True Then
                    neighbors(myX, myY) += 1
                End If
                If cells(myX + 1, myY) = True Then
                    neighbors(myX, myY) += 1
                End If
                If cells(myX + 1, myY - 1) = True Then
                    neighbors(myX, myY) += 1
                End If
                If cells(myX, myY - 1) = True Then
                    neighbors(myX, myY) += 1
                End If
                If cells(myX - 1, myY - 1) = True Then
                    neighbors(myX, myY) += 1
                End If
                If cells(myX - 1, myY) = True Then
                    neighbors(myX, myY) += 1
                End If
                If cells(myX - 1, myY + 1) = True Then
                    neighbors(myX, myY) += 1
                End If
                If cells(myX, myY + 1) = True Then
                    neighbors(myX, myY) += 1
                End If



            Next
        Next


        For changerx As Integer = 1 To 35
            For changery As Integer = 1 To 35

                Dim myX As Integer = changerx
                Dim myY As Integer = changery

                If cells(myX, myY) = True And neighbors(myX, myY) < 2 Then
                    If underpopulation = True Then
                        cells(myX, myY) = False
                    End If
                End If

                If cells(myX, myY) = True And neighbors(myX, myY) = 2 Then
                    cells(myX, myY) = True
                End If

                If cells(myX, myY) = True And neighbors(myX, myY) = 3 Then
                    cells(myX, myY) = True
                End If

                If cells(myX, myY) = True And neighbors(myX, myY) > 3 Then
                    If overpopulation = True Then
                        cells(myX, myY) = False
                    End If
                End If

                If cells(myX, myY) = False And neighbors(myX, myY) = 3 Then
                    If birth = True Then
                        cells(myX, myY) = True
                    End If
                End If






            Next
        Next

        iterationCount += 1
        iterationLabel.Text = "Iterations: " & iterationCount

    End Function


    Function renderer()
        Dim surface As Graphics = CreateGraphics()
        Dim solidBrushGreen As SolidBrush = New SolidBrush(Color.Green)
        Dim solidBrushLightGray As SolidBrush = New SolidBrush(Color.LightGray)
        Dim solidBrushDarkGray As SolidBrush = New SolidBrush(Color.DarkGray)
        Dim solidBrushBlack As SolidBrush = New SolidBrush(Color.Black)

        Dim rects(35, 35) As Rectangle






        Dim ModCheck
        For fillerx = 1 To 35
            For fillery = 1 To 35
                rects(fillerx, fillery) = New Rectangle((fillerx * 15) + 300 - 15, (fillery * 15) + 7, 15, 15)

                ModCheck = (fillerx + fillery) Mod 2



                If ModCheck = 0 Then
                    surface.FillRectangle(solidBrushLightGray, rects(fillerx, fillery))
                Else
                    surface.FillRectangle(solidBrushDarkGray, rects(fillerx, fillery))
                End If

                If cells(fillerx, fillery) = True Then
                    surface.FillRectangle(solidBrushGreen, rects(fillerx, fillery))
                End If
                If fillerx = 1 Or fillery = 1 Or fillerx = 35 Or fillery = 35 Then
                    surface.FillRectangle(solidBrushBlack, rects(fillerx, fillery))
                End If


            Next
        Next




    End Function


    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles btnIterate.Click
        doIteration()
        renderer()

    End Sub

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load

    End Sub

    Private Sub Form1_MouseClick(sender As Object, e As MouseEventArgs) Handles Me.MouseClick
        Dim xSel As Integer = (MousePosition.X - Me.Left) / 15 - 20
        Dim ySel As Integer = (MousePosition.Y - Me.Top) / 15 - 3


        If xSel > 0 And ySel > 0 And xSel < 35 And ySel < 35 Then



            If cells(xSel, ySel) = True Then
                cells(xSel, ySel) = False
            Else
                cells(xSel, ySel) = True
            End If
            renderer()
        End If


        ' Button1.Text = xSel & ", " & ySel
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles btnClear.Click
        clearboard()
        renderer()
    End Sub

    Private Sub Timer1_Tick(sender As Object, e As EventArgs) Handles Timer1.Tick
        If timerOn = True Then

            For repetition = 1 To superSpeedy
                doIteration()
            Next

            renderer()
            Timer1.Enabled = True

        Else
            Timer1.Enabled = False
        End If
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles btnStart.Click
        timerOn = True
        Timer1.Enabled = True
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles btnStop.Click
        timerOn = False
        Timer1.Enabled = False
    End Sub

    Private Sub RadioButton1_CheckedChanged(sender As Object, e As EventArgs) Handles RadioButton1.CheckedChanged
        If RadioButton1.Checked Then
            Timer1.Interval = 1000
        End If

    End Sub

    Private Sub RadioButton10_CheckedChanged(sender As Object, e As EventArgs) Handles RadioButton10.CheckedChanged
        If RadioButton10.Checked Then
            Timer1.Interval = 200
        End If
    End Sub

    Private Sub RadioButton20_CheckedChanged(sender As Object, e As EventArgs) Handles RadioButton20.CheckedChanged
        If RadioButton20.Checked Then
            Timer1.Interval = 100
        End If
    End Sub

    Private Sub RadioButton100_CheckedChanged(sender As Object, e As EventArgs) Handles RadioButton100.CheckedChanged
        If RadioButton20.Checked Then
            Timer1.Interval = 1
        End If
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles btnExit.Click
        Me.Close()
    End Sub



    Private Sub GroupBox1_Enter(sender As Object, e As EventArgs) Handles GroupBox1.Enter

    End Sub

    Private Sub RadioButton2_CheckedChanged(sender As Object, e As EventArgs) Handles RadioButton2.CheckedChanged
        If RadioButton2.Checked = True Then
            superSpeedy = 1
        End If

    End Sub

    Private Sub RadioButton3_CheckedChanged(sender As Object, e As EventArgs) Handles RadioButton3.CheckedChanged
        If RadioButton3.Checked = True Then
            superSpeedy = 5
        End If
    End Sub

    Private Sub RadioButton4_CheckedChanged(sender As Object, e As EventArgs) Handles RadioButton4.CheckedChanged
        If RadioButton4.Checked = True Then
            superSpeedy = 10
        End If
    End Sub

    Private Sub RadioButton5_CheckedChanged(sender As Object, e As EventArgs) Handles RadioButton5.CheckedChanged
        If RadioButton5.Checked = True Then
            superSpeedy = 1000
        End If
    End Sub

    Private Sub CheckBox1_CheckedChanged(sender As Object, e As EventArgs) Handles CheckBox1.CheckedChanged
        If CheckBox1.Checked Then
            underpopulation = True
        Else
            underpopulation = False
        End If
    End Sub

    Private Sub CheckBox2_CheckedChanged(sender As Object, e As EventArgs) Handles CheckBox2.CheckedChanged
        If CheckBox2.Checked Then
            overpopulation = True
        Else
            overpopulation = False
        End If
    End Sub

    Private Sub CheckBox3_CheckedChanged(sender As Object, e As EventArgs) Handles CheckBox3.CheckedChanged
        If CheckBox3.Checked Then
            birth = True
        Else
            birth = False
        End If
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles btnRefresh.Click
        renderer()
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles btnSave_debug.Click
        saveLoadTextBox.Text = saveboard()
    End Sub

    Private Sub Button8_Click(sender As Object, e As EventArgs) Handles btnLoad_debug.Click
        loadBoard(saveLoadTextBox.Text)
        renderer()


    End Sub

    Private Sub CheckBox4_CheckedChanged(sender As Object, e As EventArgs) Handles CheckBox4.CheckedChanged
        If CheckBox4.Checked Then
            btnSave_debug.Visible = True
            btnLoad_debug.Visible = True
            saveLoadTextBox.Visible = True
        Else
            btnSave_debug.Visible = False
            btnLoad_debug.Visible = False
            saveLoadTextBox.Visible = False
        End If
    End Sub

    Private Sub RadioButton6_CheckedChanged(sender As Object, e As EventArgs) Handles RadioButton6.CheckedChanged

        If RadioButton6.Checked Then
            Button1.Visible = True
            Button2.Visible = True
            Button3.Visible = True
            Button4.Visible = True
            Button5.Visible = False
            Button6.Visible = False

            Button1.Text = "Blinker"
            Button2.Text = "Figure 8"
            Button3.Text = "Pulsar"
            Button4.Text = "Penta-decathlon"

        End If



    End Sub

    Private Sub RadioButton8_CheckedChanged(sender As Object, e As EventArgs) Handles RadioButton8.CheckedChanged
        If RadioButton8.Checked Then
            Button1.Visible = True
            Button2.Visible = True
            Button3.Visible = True
            Button4.Visible = True
            Button5.Visible = False
            Button6.Visible = False

            Button1.Text = "Glider"
            Button2.Text = "Light"
            Button3.Text = "Middle"
            Button4.Text = "Heavy"

        End If
    End Sub

    Private Sub Button1_Click_1(sender As Object, e As EventArgs) Handles Button1.Click
        If RadioButton6.Checked Then

            loadBoard("0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")
            renderer()
        End If
        If RadioButton8.Checked Then
            loadBoard("0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000001100000000000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")
            renderer()

        End If

    End Sub

    Private Sub Button2_Click_1(sender As Object, e As EventArgs) Handles Button2.Click
        If RadioButton6.Checked Then

            loadBoard("0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011100000000000000000000000000000000111000000000000000000000000000000001110000000000000000000000000000000000011100000000000000000000000000000000111000000000000000000000000000000001110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")
            renderer()
        End If
        If RadioButton8.Checked Then
            loadBoard("0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000000001110000000000000000000000000000000101100000000000000000000000000000001110000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")
            renderer()

        End If
    End Sub

    Private Sub Button3_Click_1(sender As Object, e As EventArgs) Handles Button3.Click
        If RadioButton6.Checked Then

            loadBoard("0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011100011100000000000000000000000000000000000000000000000000000000000100001010000100000000000000000000001000010100001000000000000000000000010000101000010000000000000000000000001110001110000000000000000000000000000000000000000000000000000000000000111000111000000000000000000000000100001010000100000000000000000000001000010100001000000000000000000000010000101000010000000000000000000000000000000000000000000000000000000000011100011100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")
            renderer()
        End If
        If RadioButton8.Checked Then
            loadBoard("0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011000000000000000000000000000000000111000000000000000000000000000000001110000000000000000000000000000000101100000000000000000000000000000001110000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")
            renderer()

        End If
    End Sub

    Private Sub Button4_Click_1(sender As Object, e As EventArgs) Handles Button4.Click
        If RadioButton6.Checked Then

            loadBoard("0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011110000000000000000000000000000001111110000000000000000000000000000111111110000000000000000000000000011000000110000000000000000000000000011111111000000000000000000000000000011111100000000000000000000000000000011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")
            renderer()
        End If
        If RadioButton8.Checked Then
            loadBoard("0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000000001110000000000000000000000000000000011100000000000000000000000000000000111000000000000000000000000000000010110000000000000000000000000000000111000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")
            renderer()

        End If
    End Sub
End Class
